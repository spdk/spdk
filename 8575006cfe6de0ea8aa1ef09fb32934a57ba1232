{
  "comments": [
    {
      "key": {
        "uuid": "ce8a71a3_8b21d9ad",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 420,
      "author": {
        "id": 1015483
      },
      "writtenOn": "2018-11-26T00:38:56Z",
      "side": 1,
      "message": "more needed to handle decompression overflow case.\non compression overflow you probably don\u0027t care and can just store the uncompressed data.\nFor decompresssion, I\u0027d expect you have to retry with a bigger destination buffer - unless you\u0027ve saved meta data with the expected uncompressed size and so know this case can never arise?",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7142dd5b_b5fbf195",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 420,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2018-11-26T13:47:32Z",
      "side": 1,
      "message": "yes, we\u0027ll have metadata and know the precise size of the buffer.  This code isn\u0027t final by any stretch, its just to test one comp and one decomp via gdb to make sure I\u0027m constructing the ops and mbufs correctly. Lots will change w/reduce.  But you are totally right, error handling needs to be added!",
      "parentUuid": "ce8a71a3_8b21d9ad",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "96f35c6c_ca7628e7",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 499,
      "author": {
        "id": 1015483
      },
      "writtenOn": "2018-11-26T14:26:16Z",
      "side": 1,
      "message": "the len used for attach\u0026append should be the size of the buffer to be attached to the mbuf.\n\"compressed\" is the total compressed length.",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3a08ffd1_7c950790",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 499,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2018-11-26T18:35:00Z",
      "side": 1,
      "message": "\u0027compressed\u0027 is just a hacked global for this 2 IO test. Its not tot ttl length, it is currently set tot he produced element in the dequeued op for the compression\n\ncompressed \u003d deq_ops[0]-\u003eproduced;",
      "parentUuid": "96f35c6c_ca7628e7",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e97a9416_6ecaa445",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 514,
      "author": {
        "id": 1015483
      },
      "writtenOn": "2018-11-26T00:38:56Z",
      "side": 1,
      "message": "for dest I don\u0027t see a need for an SGL / mbuf chain - \njust one mbuf with the dest_iov.iov-base with it\u0027s total length attached should do fine.\nFor src, if data is already in multiple separate external buffers, then it makes sense to use same num of mbufs and chain them.",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8a4bd01f_360c56b7",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 514,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2018-11-26T13:47:32Z",
      "side": 1,
      "message": "I don\u0027t know yet (with reduce) if the dest buffer will always be contiguous or not.",
      "parentUuid": "e97a9416_6ecaa445",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ceab51a5_8029f8e9",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 520,
      "author": {
        "id": 1015483
      },
      "writtenOn": "2018-11-26T00:38:56Z",
      "side": 1,
      "message": "this should be within the for loop",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "69052b8c_33d06810",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 520,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2018-11-26T13:47:32Z",
      "side": 1,
      "message": "thanks, wasn\u0027t sure.  I assume I don\u0027t need the conditional either? And, then I would use iov_index as the index for both?",
      "parentUuid": "ceab51a5_8029f8e9",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "8a0bba9a_4c8d803a",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 520,
      "author": {
        "id": 1015483
      },
      "writtenOn": "2018-11-26T14:26:16Z",
      "side": 1,
      "message": "I\u0027d suggest separate loops for src and dest. index for each is number of buffers (\u003d nr of segments in the chain) There\u0027s no reason for indices to be the same. And every reason to minimise them, as more performant to use contiguous buffers wherever they\u0027re available.",
      "parentUuid": "69052b8c_33d06810",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "961d136f_28ff2a4c",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 520,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2018-11-26T18:35:00Z",
      "side": 1,
      "message": "will work on that after lunch, thanks!",
      "parentUuid": "8a0bba9a_4c8d803a",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9567fead_17250951",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 523,
      "author": {
        "id": 1015483
      },
      "writtenOn": "2018-11-26T00:38:56Z",
      "side": 1,
      "message": "set src.length \u003d total_length",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e6c4e7cc_80b7e968",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 535,
      "author": {
        "id": 1015483
      },
      "writtenOn": "2018-11-26T00:38:56Z",
      "side": 1,
      "message": "if this is handling decompress, it will need to take this into account in dest buffer size alloc above. Decompressed data is expected to be bigger than src data. \nIf the iobuf total length already accounts for that, then the src.length needs to reflect the actual compressed data to be processed.",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4422557b_4e8f8d79",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 535,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2018-11-26T13:47:32Z",
      "side": 1,
      "message": "I\u0027m not sure what LOC you are commenting on - I understand the statement but do you see something incorrect or missing? Where you are commenting is just a print and assignment of the pre-filled out xform which doesn\u0027t have anything to do with size right?",
      "parentUuid": "e6c4e7cc_80b7e968",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "073bb982_4ba8a437",
        "filename": "lib/bdev/compress/vbdev_compress.c",
        "patchSetId": 31
      },
      "lineNbr": 535,
      "author": {
        "id": 1015483
      },
      "writtenOn": "2018-11-26T14:26:16Z",
      "side": 1,
      "message": "ah, ok. comment is on the whole fn. I just realised with this \"if\" that it\u0027s handling both compression and decomp. I\u0027d been focused on compression.\nYes, xform has nothing to do with size.\nadded comment on line 497 above",
      "parentUuid": "4422557b_4e8f8d79",
      "revId": "8575006cfe6de0ea8aa1ef09fb32934a57ba1232",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    }
  ]
}