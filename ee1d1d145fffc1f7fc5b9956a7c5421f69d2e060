{
  "comments": [
    {
      "key": {
        "uuid": "6d4ff325_30a170d7",
        "filename": "include/spdk_internal/spdk_mock.h",
        "patchSetId": 7
      },
      "lineNbr": 35,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-06-30T16:53:17Z",
      "side": 1,
      "message": "other files in include/spdk_internal do not have an spdk prefix, so this file should probably be mock.h instead of spdk_mock.h",
      "revId": "ee1d1d145fffc1f7fc5b9956a7c5421f69d2e060",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "09198adc_87b1cc91",
        "filename": "include/spdk_internal/spdk_mock.h",
        "patchSetId": 7
      },
      "lineNbr": 35,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2017-06-30T17:03:25Z",
      "side": 1,
      "message": "can do",
      "parentUuid": "6d4ff325_30a170d7",
      "revId": "ee1d1d145fffc1f7fc5b9956a7c5421f69d2e060",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8a1619ee_951d6011",
        "filename": "test/unit/lib/nvme/nvme.c/nvme_ut.c",
        "patchSetId": 7
      },
      "lineNbr": 164,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-06-30T16:53:17Z",
      "side": 1,
      "message": "what if instead we created a MOCK_GET_STUB() macro?  then instead of needing this dummy proxy, you could DEFINE_STUB(probe_cb,xxx) and then do:\n\nMOCK_SET(probe_cb, bool, false)\nrc \u003d nvme_ctrlr_probe(trid, devhandle, MOCK_GET_STUB(probe_cb), cb_ctx);\n\nOr something like that...",
      "revId": "ee1d1d145fffc1f7fc5b9956a7c5421f69d2e060",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3b6c718a_247bf923",
        "filename": "test/unit/lib/nvme/nvme.c/nvme_ut.c",
        "patchSetId": 7
      },
      "lineNbr": 164,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2017-06-30T17:03:25Z",
      "side": 1,
      "message": "I don\u0027t have enough foresight to know how often this pattern will be needed.  How about I make a note of it and if I hit it many more times as I finish the series of patches to complete UT for nvme.c I add something like that?",
      "parentUuid": "8a1619ee_951d6011",
      "revId": "ee1d1d145fffc1f7fc5b9956a7c5421f69d2e060",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "aa3ac6dd_051d913c",
        "filename": "test/unit/lib/nvme/nvme.c/nvme_ut.c",
        "patchSetId": 7
      },
      "lineNbr": 164,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-06-30T17:35:52Z",
      "side": 1,
      "message": "This pattern is used extensively in SPDK - we pass function pointers to stubbed functions literally all over the place in the existing blobstore and blobfs unit test code for example.\n\nI\u0027m OK if you want to put it in a separate patch - but please much sooner rather than later.  :)",
      "parentUuid": "3b6c718a_247bf923",
      "revId": "ee1d1d145fffc1f7fc5b9956a7c5421f69d2e060",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "863451f4_9766e668",
        "filename": "test/unit/lib/nvme/nvme.c/nvme_ut.c",
        "patchSetId": 7
      },
      "lineNbr": 166,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-06-30T16:53:17Z",
      "side": 1,
      "message": "In light of this patch starting to set the example for future unit tests - there should probably be at least a couple of lines of comments here explaining what is being tested here and why.",
      "revId": "ee1d1d145fffc1f7fc5b9956a7c5421f69d2e060",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "71b04d1b_a1927c02",
        "filename": "test/unit/lib/nvme/nvme.c/nvme_ut.c",
        "patchSetId": 7
      },
      "lineNbr": 166,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2017-06-30T17:03:25Z",
      "side": 1,
      "message": "Heh, yeah I thought about that when I was typing that comment. The reason I didn\u0027t go into detail is to purposely not set and example that every single path needs to be explained in comment in the UT code. That\u0027s a decent amount of overhead where one could argue that the *code* should be commented to that level, not the UT code. I decided to go with that simple comment just as a separator more than anything so anyone working on that function at a later point would know where one code path was done being tested and the next one started.",
      "parentUuid": "863451f4_9766e668",
      "revId": "ee1d1d145fffc1f7fc5b9956a7c5421f69d2e060",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "84e7803a_ab577b7c",
        "filename": "test/unit/lib/nvme/nvme.c/nvme_ut.c",
        "patchSetId": 7
      },
      "lineNbr": 166,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-06-30T17:35:52Z",
      "side": 1,
      "message": "I agree - I don\u0027t want a ton of overhead.  But a single line here would go a long way to help the reader understand the unit test code instead of just saying RTFC.  Something as simple as \"Test case where probe_fn indicates to not attach\".  Or below \"Test that nvme_ctrlr_probe fails if no transport_ctrl can be constructed\".\n\nMaybe I\u0027m just overly sensitive to this based on a bunch of unit test code I just wrote to test new spdk bdev open/close functionality.  There are some complicated cases to test and without comments it would require a ton of work on the reader to try to understand why each case is important.\n\nI\u0027m OK leaving this as-is for now but we should chat more on this.  I think in the end we want to have a model example for unit tests to point people towards while we get existing tests converted and I think unit tests with zero comments explaining anything about the tests sets the wrong example.",
      "parentUuid": "71b04d1b_a1927c02",
      "revId": "ee1d1d145fffc1f7fc5b9956a7c5421f69d2e060",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "08fe50ba_9d175441",
        "filename": "test/unit/lib/nvme/nvme.c/nvme_ut.c",
        "patchSetId": 7
      },
      "lineNbr": 166,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2017-06-30T18:48:00Z",
      "side": 1,
      "message": "So I looked at this a little more and I\u0027m not sure exactly what you mean.  Without any new macros I can still get rid of the stack variable probe_cb in this example just by passing in dummy_probe_cb so it looks like this (below). Is there another simplification you see?\n\nDEFINE_STUB(dummy_probe_cb, bool,\n\t    (void *cb_ctx, const struct spdk_nvme_transport_id *trid,\n\t     struct spdk_nvme_ctrlr_opts *opts), false)\n\nstatic void\ntest_nvme_ctrlr_probe(void)\n{\n\tint rc \u003d 0;\n\tconst struct spdk_nvme_transport_id *trid \u003d NULL;\n\tvoid *devhandle \u003d NULL;\n\tvoid *cb_ctx \u003d NULL;\n\n\t/* test when probe_cb returns false */\n\tMOCK_SET(dummy_probe_cb, bool, false)\n\trc \u003d nvme_ctrlr_probe(trid, devhandle, dummy_probe_cb, cb_ctx);\n\tCU_ASSERT(rc \u003d\u003d 1);",
      "parentUuid": "84e7803a_ab577b7c",
      "revId": "ee1d1d145fffc1f7fc5b9956a7c5421f69d2e060",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "81e082e9_a6a364bf",
        "filename": "test/unit/lib/nvme/nvme.c/nvme_ut.c",
        "patchSetId": 7
      },
      "lineNbr": 171,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-06-30T16:53:17Z",
      "side": 1,
      "message": "We use /* */ comment style consistently in SPDK.\n\n(Is there a way to get astyle to check for this?)",
      "revId": "ee1d1d145fffc1f7fc5b9956a7c5421f69d2e060",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "79ff47c1_d0df5e43",
        "filename": "test/unit/lib/nvme/nvme.c/nvme_ut.c",
        "patchSetId": 7
      },
      "lineNbr": 171,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2017-06-30T17:03:25Z",
      "side": 1,
      "message": "bahm thought I got all of those.  will fix sorry",
      "parentUuid": "81e082e9_a6a364bf",
      "revId": "ee1d1d145fffc1f7fc5b9956a7c5421f69d2e060",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0ac1a5a3_f2d6d43e",
        "filename": "test/unit/lib/nvme/nvme.c/nvme_ut.c",
        "patchSetId": 7
      },
      "lineNbr": 197,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-06-30T16:53:17Z",
      "side": 1,
      "message": "Should these be 0 instead of MOCK_PASS?  We want to explicitly force this routine to return 0, not passthrough to the libc call.  MOCK_PASS will work  but using 0 keeps the exact same test behavior.\n\nSimilarly for others below.",
      "revId": "ee1d1d145fffc1f7fc5b9956a7c5421f69d2e060",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1b1004b9_e37c7312",
        "filename": "test/unit/lib/nvme/nvme.c/nvme_ut.c",
        "patchSetId": 7
      },
      "lineNbr": 197,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2017-06-30T17:03:25Z",
      "side": 1,
      "message": "yeah, you\u0027re right. it was 0 but I went hog wild when I added the MOCK_PASS define :)",
      "parentUuid": "0ac1a5a3_f2d6d43e",
      "revId": "ee1d1d145fffc1f7fc5b9956a7c5421f69d2e060",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}