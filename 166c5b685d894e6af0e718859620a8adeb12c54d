{
  "comments": [
    {
      "key": {
        "uuid": "dde61a5f_3f12dd4b",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 34
      },
      "lineNbr": 5066,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2019-04-26T20:49:35Z",
      "side": 1,
      "message": "This code is a bit messier than needed to handle the ctx \u003d\u003d NULL case.  In fact, when ctx \u003d\u003d NULL, this function is effectively a nop (except for the SPDK_ERRLOG).\n\nThis would be cleaner:\n\nif (bserrno !\u003d 0) {\n  SPDK_ERRLOG();\n}\n\nif (ctx \u003d\u003d NULL) {\n  return;\n}\n\nif (bserrno !\u003d 0) {\n  ctx-\u003ebserrno \u003d bserrno;\n}\n\nctx-\u003ecb_fn();\nfree(ctx);",
      "revId": "166c5b685d894e6af0e718859620a8adeb12c54d",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "14e56b74_307fcad6",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 34
      },
      "lineNbr": 5066,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2019-04-26T21:10:48Z",
      "side": 1,
      "message": "I agree, but with one small change:\nWe should keep old ctx-\u003ebserrno if it wasn\u0027t success, so that we return first (and I think more important) error to user:\n\n\tif (bserrno !\u003d 0 \u0026\u0026 ctx-\u003ebserrno \u003d\u003d 0) {\n\t\tctx-\u003ebserrno \u003d bserrno;\n\t}",
      "parentUuid": "dde61a5f_3f12dd4b",
      "revId": "166c5b685d894e6af0e718859620a8adeb12c54d",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a3df5d45_096358a9",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 34
      },
      "lineNbr": 5080,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2019-04-26T20:49:35Z",
      "side": 1,
      "message": "I think in conjunction with some of the earlier naming changes, this function should be:\n\n_spdk_delete_snapshot_cleanup_snapshot()",
      "revId": "166c5b685d894e6af0e718859620a8adeb12c54d",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "064f0596_4d655e1b",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 34
      },
      "lineNbr": 5080,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2019-04-26T21:10:48Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "a3df5d45_096358a9",
      "revId": "166c5b685d894e6af0e718859620a8adeb12c54d",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f2ccbf7c_f14bba45",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 34
      },
      "lineNbr": 5265,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2019-04-26T20:49:35Z",
      "side": 1,
      "message": "assert(TAILQ_EMPTY(\u0026snapshot_entry-\u003eclones))?",
      "revId": "166c5b685d894e6af0e718859620a8adeb12c54d",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "0a4ec736_fb34317c",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 34
      },
      "lineNbr": 5265,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2019-04-26T21:10:48Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "f2ccbf7c_f14bba45",
      "revId": "166c5b685d894e6af0e718859620a8adeb12c54d",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9cd55ac0_527bd46e",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 34
      },
      "lineNbr": 5289,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2019-04-26T20:49:35Z",
      "side": 1,
      "message": "should we just do this right after we remove the clone entry at line 5265?\n\nI think this should always be done - not just when snapshot-\u003eparent_id \u003d\u003d SPDK_BLOBID_INVALID.",
      "revId": "166c5b685d894e6af0e718859620a8adeb12c54d",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3b317c6d_30a1aacd",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 34
      },
      "lineNbr": 5289,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2019-04-26T21:10:48Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "9cd55ac0_527bd46e",
      "revId": "166c5b685d894e6af0e718859620a8adeb12c54d",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}