{
  "comments": [
    {
      "key": {
        "uuid": "4de09610_7beeb458",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 14,
      "author": {
        "id": 1010525
      },
      "writtenOn": "2018-01-19T21:06:35Z",
      "side": 1,
      "message": "I think this \"microsecond\" and the one below should be \"millisecond\".",
      "range": {
        "startLine": 14,
        "startChar": 29,
        "endLine": 14,
        "endChar": 40
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "88711e6a_a316168f",
        "filename": "/COMMIT_MSG",
        "patchSetId": 7
      },
      "lineNbr": 14,
      "author": {
        "id": 1011207
      },
      "writtenOn": "2018-01-22T08:06:14Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "4de09610_7beeb458",
      "range": {
        "startLine": 14,
        "startChar": 29,
        "endLine": 14,
        "endChar": 40
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bb50be6d_560f31c6",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 874,
      "author": {
        "id": 1010525
      },
      "writtenOn": "2018-01-19T21:06:35Z",
      "side": 1,
      "message": "We should prevent execution from ever getting here with bdev-\u003eqos_channel \u003d\u003d NULL, so the assert() is okay, but I don\u0027t think the ERRLOG should be necessary.",
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "69a01423_28f98533",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 874,
      "author": {
        "id": 1011207
      },
      "writtenOn": "2018-01-22T08:06:14Z",
      "side": 1,
      "message": "Thanks for this comment. For the case of qos not properly setting up, will just send it normally. The change is addressed in the RPC enable patch, will move it here.",
      "parentUuid": "bb50be6d_560f31c6",
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c288b5d4_337a77be",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 878,
      "author": {
        "id": 1012251
      },
      "writtenOn": "2018-01-17T07:30:39Z",
      "side": 1,
      "message": "If message is send even on the qos_thread, why the submit function for QoS cannot be set into message?",
      "range": {
        "startLine": 878,
        "startChar": 2,
        "endLine": 878,
        "endChar": 72
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "21425f8e_9d89cf11",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 878,
      "author": {
        "id": 1011207
      },
      "writtenOn": "2018-01-22T08:06:14Z",
      "side": 1,
      "message": "Sorry I did not catch what\u0027s the question here. Here just put the IOs onto the qos_thread from other threads when QoS is enabled.",
      "parentUuid": "c288b5d4_337a77be",
      "range": {
        "startLine": 878,
        "startChar": 2,
        "endLine": 878,
        "endChar": 72
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5e506bec_5b0c3000",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 1004,
      "author": {
        "id": 1012251
      },
      "writtenOn": "2018-01-17T07:30:39Z",
      "side": 1,
      "message": "This may be related with Daniel\u0027s feedback.\nif creating qos_channel is failed, freeing qos_channel in this function may be easier to understand. Please get feedback from other reviewers.",
      "range": {
        "startLine": 1004,
        "startChar": 8,
        "endLine": 1004,
        "endChar": 19
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "26a8483d_7a1b1b28",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 1014,
      "author": {
        "id": 1012251
      },
      "writtenOn": "2018-01-17T07:30:39Z",
      "side": 1,
      "message": "_spdk_bdev_channel_create in the line 1014 and 1057 looks confusing for me.",
      "range": {
        "startLine": 1014,
        "startChar": 6,
        "endLine": 1014,
        "endChar": 31
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1db042f6_141b9fa0",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 1037,
      "author": {
        "id": 1012251
      },
      "writtenOn": "2018-01-17T07:30:39Z",
      "side": 1,
      "message": "This was set by the qos_thread. Hence this should be nullified by the qos_thread at least.",
      "range": {
        "startLine": 1037,
        "startChar": 1,
        "endLine": 1037,
        "endChar": 25
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2b6a3542_048b1c1c",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 1037,
      "author": {
        "id": 1011207
      },
      "writtenOn": "2018-01-22T08:06:14Z",
      "side": 1,
      "message": "This function can also be executed at the master thread to create qos bdev channel at failure. Since it is a global setting on bdev structure for the qos information, from my perspective, it\u0027s ok to clean up here. Thanks.",
      "parentUuid": "1db042f6_141b9fa0",
      "range": {
        "startLine": 1037,
        "startChar": 1,
        "endLine": 1037,
        "endChar": 25
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e3ac6638_ea6330c2",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 1040,
      "author": {
        "id": 1010525
      },
      "writtenOn": "2018-01-19T21:06:35Z",
      "side": 1,
      "message": "Is it possible for this case to happen (barring other programming errors inside the bdev layer)? If not, I don\u0027t think we need to check/errlog it, and if so, it seems like this would be a silent cleanup path to exit early, not something that needs an error message.",
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "3d272514_5b177dab",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 1040,
      "author": {
        "id": 1011207
      },
      "writtenOn": "2018-01-22T08:06:14Z",
      "side": 1,
      "message": "This code could also be executed when failing to create bdev channel (and qos bdev channel). The poller can be not registered yet. I can change the ERRLOG to DEBUGLOG.",
      "parentUuid": "e3ac6638_ea6330c2",
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f3a7cc97_21d8ad54",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 1044,
      "author": {
        "id": 1012251
      },
      "writtenOn": "2018-01-17T07:30:39Z",
      "side": 1,
      "message": "Ensuring to call this function on the qos_thread is not possible? qos_thread is not migrated if qos_channel exits?",
      "range": {
        "startLine": 1044,
        "startChar": 1,
        "endLine": 1044,
        "endChar": 34
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "8a6683c9_979affe9",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 1044,
      "author": {
        "id": 1011207
      },
      "writtenOn": "2018-01-22T08:06:14Z",
      "side": 1,
      "message": "When multiple channels are configured, the last bdev channel destroy could happen on any channel/thread. Add this check is for a fast patch operation. Thanks.",
      "parentUuid": "f3a7cc97_21d8ad54",
      "range": {
        "startLine": 1044,
        "startChar": 1,
        "endLine": 1044,
        "endChar": 34
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5904e38c_dc30d129",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 1062,
      "author": {
        "id": 1012251
      },
      "writtenOn": "2018-01-17T07:30:39Z",
      "side": 1,
      "message": "to bring this line to the line 1072 and remove the line 1067 may be simpler.",
      "range": {
        "startLine": 1062,
        "startChar": 1,
        "endLine": 1062,
        "endChar": 23
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "713b9ac0_bb7df6c3",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 1201,
      "author": {
        "id": 1012251
      },
      "writtenOn": "2018-01-17T07:30:39Z",
      "side": 1,
      "message": "Is this multi processor safe if this is not called on the qos_thread?",
      "range": {
        "startLine": 1201,
        "startChar": 2,
        "endLine": 1201,
        "endChar": 32
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9c645faf_fced01f7",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 1230,
      "author": {
        "id": 1012251
      },
      "writtenOn": "2018-01-17T07:30:39Z",
      "side": 1,
      "message": "Detecting qos_channel exit and migrating it to the other channel is not planned in this patch series?\n\nThe maximum we do is just reference counting in this patch series?\n\n\nP.S.\n\nMigrating queued IOs to other thread will be difficult and I have proposed hybrid pool mechanism. I wish you have found any solution in later patches.",
      "range": {
        "startLine": 1230,
        "startChar": 2,
        "endLine": 1230,
        "endChar": 33
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1fccdc24_2478a984",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 2032,
      "author": {
        "id": 1010525
      },
      "writtenOn": "2018-01-19T21:06:35Z",
      "side": 1,
      "message": "This looks a bit misleadingly named, as it will be called for non-QoS I/O as well.",
      "range": {
        "startLine": 2032,
        "startChar": 0,
        "endLine": 2032,
        "endChar": 26
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c79c2de3_984b578a",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 2032,
      "author": {
        "id": 1011207
      },
      "writtenOn": "2018-01-22T08:06:14Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1fccdc24_2478a984",
      "range": {
        "startLine": 2032,
        "startChar": 0,
        "endLine": 2032,
        "endChar": 26
      },
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "58fa42d5_eee4da6e",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 2113,
      "author": {
        "id": 1010525
      },
      "writtenOn": "2018-01-19T21:06:35Z",
      "side": 1,
      "message": "It seems likely that the extra work to check the conditionals will be more overhead than just doing the increment even when QoS is not enabled.",
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "99c1a609_12ca8baf",
        "filename": "lib/bdev/bdev.c",
        "patchSetId": 7
      },
      "lineNbr": 2113,
      "author": {
        "id": 1011207
      },
      "writtenOn": "2018-01-22T08:06:14Z",
      "side": 1,
      "message": "In this way, shall we check the STATUS_SUCCESS case? Here I only count in the successfully completed IOs.",
      "parentUuid": "58fa42d5_eee4da6e",
      "revId": "fd82eb33b9e98538b9b37abb6a100389ffc249fb",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}