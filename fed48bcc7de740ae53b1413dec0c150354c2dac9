{
  "comments": [
    {
      "key": {
        "uuid": "719ba53a_24cf6bb4",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 7,
      "author": {
        "id": 1010525
      },
      "writtenOn": "2018-06-05T18:13:30Z",
      "side": 1,
      "message": "ndb -\u003e nbd",
      "range": {
        "startLine": 7,
        "startChar": 0,
        "endLine": 7,
        "endChar": 3
      },
      "revId": "fed48bcc7de740ae53b1413dec0c150354c2dac9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0d9133f0_dc4f7fa3",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 9,
      "author": {
        "id": 1010525
      },
      "writtenOn": "2018-06-05T18:13:30Z",
      "side": 1,
      "message": "robouse -\u003e robust?",
      "range": {
        "startLine": 9,
        "startChar": 24,
        "endLine": 9,
        "endChar": 31
      },
      "revId": "fed48bcc7de740ae53b1413dec0c150354c2dac9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "131cb391_ccb63c5c",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 29,
      "author": {
        "id": 1013793
      },
      "writtenOn": "2018-06-06T09:21:15Z",
      "side": 1,
      "message": "I\u0027m not seeing that in my failure scenario. /dev/nbd0 is working fine, it\u0027s just the following JSON RPC call which doesn\u0027t get a response.",
      "revId": "fed48bcc7de740ae53b1413dec0c150354c2dac9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3ed2c773_2b9c65f3",
        "filename": "/COMMIT_MSG",
        "patchSetId": 3
      },
      "lineNbr": 36,
      "author": {
        "id": 1013793
      },
      "writtenOn": "2018-06-06T09:21:15Z",
      "side": 1,
      "message": "Unfortunately not :-/ #322 is something else.",
      "revId": "fed48bcc7de740ae53b1413dec0c150354c2dac9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ce69037d_53e24cbc",
        "filename": "lib/nbd/nbd.c",
        "patchSetId": 3
      },
      "lineNbr": 794,
      "author": {
        "id": 1010525
      },
      "writtenOn": "2018-06-05T18:13:30Z",
      "side": 1,
      "message": "What happens if we loop around and call this more than once? Is the kernel prepared to handle this?\n\nThe only reason I ask is that the nbd sample userspace code does not seem to handle the EINTR case at all; it looks like it actually closes the socket and reconnects if the ioctl() returns an error code.\n\nDoes the bug fix work correctly if we remove the \u0027while\u0027 loop and just call the ioctl() once?",
      "revId": "fed48bcc7de740ae53b1413dec0c150354c2dac9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "7d1bf56f_7274bbe2",
        "filename": "lib/nbd/nbd.c",
        "patchSetId": 3
      },
      "lineNbr": 794,
      "author": {
        "id": 1011230
      },
      "writtenOn": "2018-06-06T14:03:26Z",
      "side": 1,
      "message": "yes, it works, so lets revert this.",
      "parentUuid": "ce69037d_53e24cbc",
      "revId": "fed48bcc7de740ae53b1413dec0c150354c2dac9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0fb082f1_327c322e",
        "filename": "lib/nbd/nbd.c",
        "patchSetId": 3
      },
      "lineNbr": 800,
      "author": {
        "id": 1011218
      },
      "writtenOn": "2018-06-05T15:48:50Z",
      "side": 1,
      "message": "should we unset nbd-\u003ekernel_started here?",
      "revId": "fed48bcc7de740ae53b1413dec0c150354c2dac9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "4c54056d_1209290a",
        "filename": "lib/nbd/nbd.c",
        "patchSetId": 3
      },
      "lineNbr": 800,
      "author": {
        "id": 1011218
      },
      "writtenOn": "2018-06-05T15:50:15Z",
      "side": 1,
      "message": "(otherwise you might try to join a thread that\u0027s already dead. I believe that\u0027s what this flag was initially meant for)",
      "parentUuid": "0fb082f1_327c322e",
      "revId": "fed48bcc7de740ae53b1413dec0c150354c2dac9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3fb2f08f_96a803a9",
        "filename": "lib/nbd/nbd.c",
        "patchSetId": 3
      },
      "lineNbr": 800,
      "author": {
        "id": 1011230
      },
      "writtenOn": "2018-06-05T16:37:20Z",
      "side": 1,
      "message": "this is not detached thread anymore (see changes in spdk_nbd_start() ) so it need to be always waited.",
      "parentUuid": "4c54056d_1209290a",
      "revId": "fed48bcc7de740ae53b1413dec0c150354c2dac9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6665147e_4b21db10",
        "filename": "lib/nbd/nbd.c",
        "patchSetId": 3
      },
      "lineNbr": 800,
      "author": {
        "id": 1011218
      },
      "writtenOn": "2018-06-05T17:27:24Z",
      "side": 1,
      "message": "OK, unsetting this flag makes no sense. But what\u0027s the flag for, then? You obviously can\u0027t stop an nbd disk before its spdk_nbd_start() returns.",
      "parentUuid": "3fb2f08f_96a803a9",
      "revId": "fed48bcc7de740ae53b1413dec0c150354c2dac9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "90040682_45a40438",
        "filename": "lib/nbd/nbd.c",
        "patchSetId": 3
      },
      "lineNbr": 800,
      "author": {
        "id": 1011230
      },
      "writtenOn": "2018-06-05T17:32:58Z",
      "side": 1,
      "message": "because there is no PTHREAD_INVALID_ID so I can\u0027t comapre nbd-\u003ekernel_tid against it and during stop don\u0027t know if nbd-\u003ekernel_tid is valid for cancelation and joining or not.",
      "parentUuid": "6665147e_4b21db10",
      "revId": "fed48bcc7de740ae53b1413dec0c150354c2dac9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "212b6427_5ec05483",
        "filename": "lib/nbd/nbd.c",
        "patchSetId": 3
      },
      "lineNbr": 919,
      "author": {
        "id": 1010525
      },
      "writtenOn": "2018-06-05T18:13:30Z",
      "side": 1,
      "message": "This looks sketchy; why do we need to sleep here?  What would happen if we remove this loop?",
      "revId": "fed48bcc7de740ae53b1413dec0c150354c2dac9",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}