{
  "comments": [
    {
      "key": {
        "uuid": "e87390df_ea2fb805",
        "filename": "lib/bdev/ocssd/bdev_ocssd.c",
        "patchSetId": 23
      },
      "lineNbr": 176,
      "author": {
        "id": 1011221
      },
      "writtenOn": "2018-11-23T15:12:21Z",
      "side": 1,
      "message": "Why is ref_cnt needed for ctrlr ? I though that single controller can be surfaced just once. Besides looking at line 199, it doesn\u0027t seem to affect anything.",
      "range": {
        "startLine": 176,
        "startChar": 0,
        "endLine": 176,
        "endChar": 25
      },
      "revId": "bd6bbe0a3ad2780bc20617cd524c5faddd7fdbfc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "844d1c97_c2ad7782",
        "filename": "lib/bdev/ocssd/bdev_ocssd.c",
        "patchSetId": 23
      },
      "lineNbr": 176,
      "author": {
        "id": 1015368
      },
      "writtenOn": "2018-11-26T15:34:36Z",
      "side": 1,
      "message": "I believe the idea was to count the number of devices created on each controller and release it once all of the devices using it were freed. You\u0027re right, it\u0027s not used right now, we should detach the controller when ref_cnt \u003d\u003d 0.",
      "parentUuid": "e87390df_ea2fb805",
      "range": {
        "startLine": 176,
        "startChar": 0,
        "endLine": 176,
        "endChar": 25
      },
      "revId": "bd6bbe0a3ad2780bc20617cd524c5faddd7fdbfc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5604225e_27b31ebf",
        "filename": "lib/bdev/ocssd/bdev_ocssd.c",
        "patchSetId": 23
      },
      "lineNbr": 453,
      "author": {
        "id": 1011221
      },
      "writtenOn": "2018-11-23T15:12:21Z",
      "side": 1,
      "message": "In bdev_nvme those options are set for whole module (either from config or to be set before app reaches RUNNING state).\nThose would have to be either taken from NVME section or the interface for creation of bdev_nvme/ocssd should be shared.\n\nAt this time timout_cb handling is missing so they don\u0027t do anything.",
      "range": {
        "startLine": 452,
        "startChar": 0,
        "endLine": 453,
        "endChar": 17
      },
      "revId": "bd6bbe0a3ad2780bc20617cd524c5faddd7fdbfc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "436357a6_afb619d2",
        "filename": "lib/bdev/ocssd/bdev_ocssd.c",
        "patchSetId": 23
      },
      "lineNbr": 681,
      "author": {
        "id": 1011221
      },
      "writtenOn": "2018-11-23T15:12:21Z",
      "side": 1,
      "message": "There should be a check if ctrlr is already attached (present in g_ocssd_bdev_ctrlrs list). This way attach_cb won\u0027t be called on that ctrlr.",
      "revId": "bd6bbe0a3ad2780bc20617cd524c5faddd7fdbfc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "50d493d8_4331b752",
        "filename": "lib/bdev/ocssd/bdev_ocssd.c",
        "patchSetId": 23
      },
      "lineNbr": 681,
      "author": {
        "id": 1015368
      },
      "writtenOn": "2018-11-26T15:34:36Z",
      "side": 1,
      "message": "I was under the impression, that once we attach to a controller, it won\u0027t show up in subsequent probes. Isn\u0027t that the case? If so, we already first check the controllers on the bdev_ctrlr list (see bdev_ocssd_ctrlr_create).",
      "parentUuid": "436357a6_afb619d2",
      "revId": "bd6bbe0a3ad2780bc20617cd524c5faddd7fdbfc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6ec4975e_875cce22",
        "filename": "lib/bdev/ocssd/bdev_ocssd.c",
        "patchSetId": 23
      },
      "lineNbr": 861,
      "author": {
        "id": 1011221
      },
      "writtenOn": "2018-11-23T15:12:21Z",
      "side": 1,
      "message": "Is it possible to verify that this ctrlr is OCSSD one ? spdk_nvme_probe attach_cb for both bdev_nvme.c and bdev_ocssd.c should both contain such check. Otherwise we could run into failures in either of the attaches or taking over the ctrlr by incorrect module.",
      "revId": "bd6bbe0a3ad2780bc20617cd524c5faddd7fdbfc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a90c8940_a1727b85",
        "filename": "lib/bdev/ocssd/bdev_ocssd.c",
        "patchSetId": 23
      },
      "lineNbr": 951,
      "author": {
        "id": 1011221
      },
      "writtenOn": "2018-11-23T15:12:21Z",
      "side": 1,
      "message": "The initialization path could use an improvement. This function is called from bdev initialization and create RPC.\nIf so, then it should handle a single bdev creation, rather than probe all devices.\nPlease see following comments",
      "range": {
        "startLine": 951,
        "startChar": 0,
        "endLine": 951,
        "endChar": 21
      },
      "revId": "bd6bbe0a3ad2780bc20617cd524c5faddd7fdbfc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c34defcb_ffeefabe",
        "filename": "lib/bdev/ocssd/bdev_ocssd.c",
        "patchSetId": 23
      },
      "lineNbr": 951,
      "author": {
        "id": 1015368
      },
      "writtenOn": "2018-11-27T13:23:39Z",
      "side": 1,
      "message": "I agree this should create a single bdev and if more bdevs need to be created it should just be called multiple times. See the latest patch, it\u0027s changed there.",
      "parentUuid": "a90c8940_a1727b85",
      "range": {
        "startLine": 951,
        "startChar": 0,
        "endLine": 951,
        "endChar": 21
      },
      "revId": "bd6bbe0a3ad2780bc20617cd524c5faddd7fdbfc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c39ce2a5_e23f8f99",
        "filename": "lib/bdev/ocssd/bdev_ocssd.c",
        "patchSetId": 23
      },
      "lineNbr": 979,
      "author": {
        "id": 1011221
      },
      "writtenOn": "2018-11-23T15:12:21Z",
      "side": 1,
      "message": "When will this trigger ? When initialization happens there are no items in g_ocssd_bdev_ctrlrs. On RPC just that particular ctrlr would need to be created, and after spdk_nvme_probe() rather than before.",
      "range": {
        "startLine": 976,
        "startChar": 0,
        "endLine": 979,
        "endChar": 2
      },
      "revId": "bd6bbe0a3ad2780bc20617cd524c5faddd7fdbfc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "05cc744f_c42b5d8d",
        "filename": "lib/bdev/ocssd/bdev_ocssd.c",
        "patchSetId": 23
      },
      "lineNbr": 979,
      "author": {
        "id": 1015368
      },
      "writtenOn": "2018-11-26T15:34:36Z",
      "side": 1,
      "message": "This will trigger when the user creates a bdev via RPC on a controller that already has bdevs using it.",
      "parentUuid": "c39ce2a5_e23f8f99",
      "range": {
        "startLine": 976,
        "startChar": 0,
        "endLine": 979,
        "endChar": 2
      },
      "revId": "bd6bbe0a3ad2780bc20617cd524c5faddd7fdbfc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "eb4016e0_03bd0949",
        "filename": "lib/bdev/ocssd/bdev_ocssd.c",
        "patchSetId": 23
      },
      "lineNbr": 981,
      "author": {
        "id": 1011221
      },
      "writtenOn": "2018-11-23T15:12:21Z",
      "side": 1,
      "message": "All nvme devices are probed using NULL argument here. This should only be used in initialization path to probe all devices not yet attached.",
      "range": {
        "startLine": 981,
        "startChar": 21,
        "endLine": 981,
        "endChar": 25
      },
      "revId": "bd6bbe0a3ad2780bc20617cd524c5faddd7fdbfc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "5479be9e_f478c5c3",
        "filename": "lib/bdev/ocssd/bdev_ocssd.c",
        "patchSetId": 23
      },
      "lineNbr": 981,
      "author": {
        "id": 1015368
      },
      "writtenOn": "2018-11-27T13:23:39Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "eb4016e0_03bd0949",
      "range": {
        "startLine": 981,
        "startChar": 21,
        "endLine": 981,
        "endChar": 25
      },
      "revId": "bd6bbe0a3ad2780bc20617cd524c5faddd7fdbfc",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    }
  ]
}