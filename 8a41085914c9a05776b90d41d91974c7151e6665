{
  "comments": [
    {
      "key": {
        "uuid": "9faaf923_727390f7",
        "filename": "include/spdk/opal.h",
        "patchSetId": 20
      },
      "lineNbr": 183,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2019-10-21T17:43:48Z",
      "side": 1,
      "message": "how does this \"int\" return value differ from the \"rc\" value passed to the spdk_opal_revert_cb?",
      "revId": "8a41085914c9a05776b90d41d91974c7151e6665",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "35bff1a2_2bba4988",
        "filename": "include/spdk/opal.h",
        "patchSetId": 20
      },
      "lineNbr": 183,
      "author": {
        "id": 1011792
      },
      "writtenOn": "2019-10-22T04:25:44Z",
      "side": 1,
      "message": "Hi Jim, thanks for your review. The \"int\" return value here is to let the caller know whether it receive a final result. If it return with -EAGAIN, there is no final result and need to continue calling this.\nIf we get a final result, no matter an error or success, the return code will be put also in spdk_opal_revert_cb as the rc. And in the revert_cb, the rc will be captured.",
      "parentUuid": "9faaf923_727390f7",
      "revId": "8a41085914c9a05776b90d41d91974c7151e6665",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "7eeb8f91_0762f36c",
        "filename": "lib/nvme/nvme_opal.c",
        "patchSetId": 20
      },
      "lineNbr": 2100,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2019-10-21T17:43:48Z",
      "side": 1,
      "message": "it might be better to just require the caller to specify a revert_cb_fn when calling spdk_opal_cmd_revert_tper_async; then here you can just assert()",
      "revId": "8a41085914c9a05776b90d41d91974c7151e6665",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e8a2bafe_ae39becc",
        "filename": "lib/nvme/nvme_opal.c",
        "patchSetId": 20
      },
      "lineNbr": 2100,
      "author": {
        "id": 1011792
      },
      "writtenOn": "2019-10-22T04:25:44Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "7eeb8f91_0762f36c",
      "revId": "8a41085914c9a05776b90d41d91974c7151e6665",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "756b537e_e8c22506",
        "filename": "lib/nvme/nvme_opal.c",
        "patchSetId": 20
      },
      "lineNbr": 2109,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2019-10-21T17:43:48Z",
      "side": 1,
      "message": "this seems confusing to me - we pass the error code to the revert_cb_fn, but then this revert_cb_fn can return a status code back here which we then return back to the spdk_opal_revert_poll() caller?\n\nit seems to me this should only have two valid return values: -EAGAIN and 0, and dev-\u003erevert_cb_fn should return void; then here you just call dev-\u003erevert_cb_fn() and return 0.",
      "revId": "8a41085914c9a05776b90d41d91974c7151e6665",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "714f2f4c_93b849e5",
        "filename": "lib/nvme/nvme_opal.c",
        "patchSetId": 20
      },
      "lineNbr": 2109,
      "author": {
        "id": 1011792
      },
      "writtenOn": "2019-10-22T04:25:44Z",
      "side": 1,
      "message": "Hi Jim, thanks for your review. I think you are right. Two return value seems redundant here. I will make dev-\u003erevert_cb_fn return void. Thank you.",
      "parentUuid": "756b537e_e8c22506",
      "revId": "8a41085914c9a05776b90d41d91974c7151e6665",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9f1f38b4_ce1a283c",
        "filename": "lib/nvme/nvme_opal.c",
        "patchSetId": 20
      },
      "lineNbr": 2628,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2019-10-21T17:43:48Z",
      "side": 1,
      "message": "can this just be a static function?  I don\u0027t see where this called outside of this file\n\nwe should not add function declarations in header files unless they are needed - if the function is only called and needed from one file, just declare it static and keep it in the .c file\n\nSo then this function definitions needs to move just before it is used (before spdk_opal_close) so you can avoid a forward declaration in this file",
      "revId": "8a41085914c9a05776b90d41d91974c7151e6665",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3425c029_a1a523aa",
        "filename": "lib/nvme/nvme_opal.c",
        "patchSetId": 20
      },
      "lineNbr": 2628,
      "author": {
        "id": 1011792
      },
      "writtenOn": "2019-10-22T04:25:44Z",
      "side": 1,
      "message": "This is also needed when deleting an opal bdev. Please check this patch https://review.gerrithub.io/c/spdk/spdk/+/468917/20. Thank you for your review.",
      "parentUuid": "9f1f38b4_ce1a283c",
      "revId": "8a41085914c9a05776b90d41d91974c7151e6665",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}