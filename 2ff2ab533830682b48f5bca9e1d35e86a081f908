{
  "comments": [
    {
      "key": {
        "uuid": "2bfda04b_2b72cd15",
        "filename": "lib/ftl/ftl_core.c",
        "patchSetId": 2
      },
      "lineNbr": 739,
      "author": {
        "id": 1015368
      },
      "writtenOn": "2019-03-11T16:03:07Z",
      "side": 1,
      "message": "Couldn\u0027t we just set to rc to whatever the spdk_nvme_ns_cmd_read returns (if its non-zero of course)?",
      "range": {
        "startLine": 736,
        "startChar": 0,
        "endLine": 739,
        "endChar": 18
      },
      "revId": "2ff2ab533830682b48f5bca9e1d35e86a081f908",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2e530dc4_71a3ab4f",
        "filename": "lib/ftl/ftl_core.c",
        "patchSetId": 2
      },
      "lineNbr": 739,
      "author": {
        "id": 1015344
      },
      "writtenOn": "2019-03-12T07:45:14Z",
      "side": 1,
      "message": "Yes, this should be ok, but I just wondering what was our motivation to do this in such way?",
      "parentUuid": "2bfda04b_2b72cd15",
      "range": {
        "startLine": 736,
        "startChar": 0,
        "endLine": 739,
        "endChar": 18
      },
      "revId": "2ff2ab533830682b48f5bca9e1d35e86a081f908",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9f8c89ce_f6b7316f",
        "filename": "lib/ftl/ftl_core.c",
        "patchSetId": 2
      },
      "lineNbr": 1429,
      "author": {
        "id": 1015368
      },
      "writtenOn": "2019-03-11T16:03:07Z",
      "side": 1,
      "message": "The user still needs to handle this case very similarly to one of the nvme functions returning ENOMEM. So what\u0027s the advantage of getting rid of the ftl_io_read return code?",
      "range": {
        "startLine": 1425,
        "startChar": 0,
        "endLine": 1429,
        "endChar": 2
      },
      "revId": "2ff2ab533830682b48f5bca9e1d35e86a081f908",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f3923694_76acada3",
        "filename": "lib/ftl/ftl_core.c",
        "patchSetId": 2
      },
      "lineNbr": 1429,
      "author": {
        "id": 1015344
      },
      "writtenOn": "2019-03-12T07:45:14Z",
      "side": 1,
      "message": "Returning ENOMEM directly from spdk_ftl_read is ok. I removed return value from ftl_io_read because we have sync and async path there and I want have consistent error handling for both paths. Consider case when we are splitting IO - we could end up with situation that we submitted one piece of IO to disk and next one get ENOMEM - if we return this error to user in sync path we also propagate this error second time in completion callback and bad things can happen then. On the other hand if user submit IO from other thread it loos this sync return error handling anyway.",
      "parentUuid": "9f8c89ce_f6b7316f",
      "range": {
        "startLine": 1425,
        "startChar": 0,
        "endLine": 1429,
        "endChar": 2
      },
      "revId": "2ff2ab533830682b48f5bca9e1d35e86a081f908",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9ae0b9fc_b1cefafd",
        "filename": "lib/ftl/ftl_core.c",
        "patchSetId": 2
      },
      "lineNbr": 1429,
      "author": {
        "id": 1015368
      },
      "writtenOn": "2019-03-12T08:48:13Z",
      "side": 1,
      "message": "I think we should change the way we handle the ENOMEM returned by the NVMe layer entirely. We shouldn\u0027t pass them to the user. Each ftl_io_channel should have a queue with such requests and we should periodically check this queues (and perhaps also check it when doing another IO on the same IO channel). That way we\u0027ll never throw away partially read data.",
      "parentUuid": "f3923694_76acada3",
      "range": {
        "startLine": 1425,
        "startChar": 0,
        "endLine": 1429,
        "endChar": 2
      },
      "revId": "2ff2ab533830682b48f5bca9e1d35e86a081f908",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e5c39ef0_3c7b0c63",
        "filename": "lib/ftl/ftl_core.c",
        "patchSetId": 2
      },
      "lineNbr": 1429,
      "author": {
        "id": 1015344
      },
      "writtenOn": "2019-03-12T08:58:14Z",
      "side": 1,
      "message": "Yes, I\u0027m aware that we should change our internal ENOMEM mechanism. You could refer to discussion on https://review.gerrithub.io/c/spdk/spdk/+/446610\nI would like to merge this change as it is potential bug fix.",
      "parentUuid": "9ae0b9fc_b1cefafd",
      "range": {
        "startLine": 1425,
        "startChar": 0,
        "endLine": 1429,
        "endChar": 2
      },
      "revId": "2ff2ab533830682b48f5bca9e1d35e86a081f908",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "1eae4a43_f441c939",
        "filename": "lib/ftl/ftl_core.c",
        "patchSetId": 2
      },
      "lineNbr": 1429,
      "author": {
        "id": 1015368
      },
      "writtenOn": "2019-03-12T11:47:23Z",
      "side": 1,
      "message": "If this does fixes something I\u0027m fine with merging it, as long as the proper mechanism is implemented in the nearest future.",
      "parentUuid": "e5c39ef0_3c7b0c63",
      "range": {
        "startLine": 1425,
        "startChar": 0,
        "endLine": 1429,
        "endChar": 2
      },
      "revId": "2ff2ab533830682b48f5bca9e1d35e86a081f908",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": true
    }
  ]
}