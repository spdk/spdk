{
  "comments": [
    {
      "key": {
        "uuid": "f61d0425_b4b3de38",
        "filename": "doc/blobfs.md",
        "patchSetId": 8
      },
      "lineNbr": 37,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-08-30T15:25:02Z",
      "side": 1,
      "message": "I propose we just remove reference to 2MB huge pages in this description.  We also do not need to reference HRHUGE at all - this is an implementation detail of setup.sh script.\n\nSo you can just make this:\n\n7. Make sure you have at least 5GB of memory allocated for huge pages.  By default the SPDK setup.sh script only allocates 2GB of huge page memory.  The following will allocate 5GB of huge page memory (in addition to binding the NVMe devices to uio/vfio).\n\nHUGEMEM\u003d5120 scripts/setup.sh",
      "revId": "ceaebb6479ea29b183be53fa324dca6bb0ac2d49",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a83735bf_4ef0e687",
        "filename": "scripts/autotest_common.sh",
        "patchSetId": 8
      },
      "lineNbr": 205,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-08-30T15:25:02Z",
      "side": 1,
      "message": "Why make this change?",
      "revId": "ceaebb6479ea29b183be53fa324dca6bb0ac2d49",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d529db67_090ab0c9",
        "filename": "scripts/setup.sh",
        "patchSetId": 8
      },
      "lineNbr": 250,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-08-30T15:25:02Z",
      "side": 1,
      "message": "As Pawel suggested in previous review, we should check that HUGEMEM % 2 \u003d\u003d 0 (if using 2MB huge pages) and HUGEMEM % 1024 \u003d\u003d 0 (if using 1GB huge pages).  If this is not true, the script should print an error and exit.",
      "revId": "ceaebb6479ea29b183be53fa324dca6bb0ac2d49",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "965d210a_46fa3c29",
        "filename": "scripts/setup.sh",
        "patchSetId": 8
      },
      "lineNbr": 253,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-08-30T15:27:34Z",
      "side": 1,
      "message": "This needs to be done inside of configure_linux function, since /proc/meminfo is not available on FreeBSD.\n\nFor FreeBSD, all huge pages are 256MB.",
      "revId": "ceaebb6479ea29b183be53fa324dca6bb0ac2d49",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4593ed35_8bc8a880",
        "filename": "scripts/setup.sh",
        "patchSetId": 8
      },
      "lineNbr": 253,
      "author": {
        "id": 1010525
      },
      "writtenOn": "2017-08-30T17:22:08Z",
      "side": 1,
      "message": "I\u0027m not sure looking at Hugepagesize is the right thing to do anyway.  I believe it is possible to configure a system with multiple supported hugepage sizes.  The value in /proc/meminfo\u0027s Hugepagesize is just the default.\n\nFor example, I booted my system with \u0027hugepagesz\u003d1GB hugepages\u003d4\u0027 on the Linux command line and ran the current scripts/setup.sh, and I get:\n\n    $ hugeadm --pool-list\n          Size  Minimum  Current  Maximum  Default\n       2097152     1024     1024     1024        *\n    1073741824        4        4        4\n\n/proc/meminfo Hugepagesize still says 2048 kB, but I have both 2 MB and 1 GB hugepages available.  We might need to extend scripts/setup.sh with more options if we want to fully support this kind of configuration.",
      "parentUuid": "965d210a_46fa3c29",
      "revId": "ceaebb6479ea29b183be53fa324dca6bb0ac2d49",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ea1cae60_f2c2fe8c",
        "filename": "scripts/setup.sh",
        "patchSetId": 8
      },
      "lineNbr": 255,
      "author": {
        "id": 1010525
      },
      "writtenOn": "2017-08-30T17:22:08Z",
      "side": 1,
      "message": "You can simplify this to:\n\n  NRHUGE\u003d$((HUGEMEM / 2))\n\nThe \u0027expr\u0027 isn\u0027t doing anything, since you already calculated HUGEMEM/2 in the $(()), and the $ variable prefix isn\u0027t necessary in $(()).",
      "revId": "ceaebb6479ea29b183be53fa324dca6bb0ac2d49",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}