{
  "comments": [
    {
      "key": {
        "uuid": "bd9c3b92_8a3ba73a",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 4
      },
      "lineNbr": 1335,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-09-21T17:24:04Z",
      "side": 1,
      "message": "I think here if you have the unload cb_fn and cb_arg saved in bs-\u003edev, you could copy them to local variables, call bs-\u003edev-\u003edestroy() and then at the end do the callback but with the local variables instead of referencing bs-\u003edev.\n\nOr alternatively, stuff an spdk_bs_dev structure itself into spdk_blob_store, and copy the contents during init/load (instead of saving the pointer).  I think that makes your life easier here, plus users don\u0027t have to remember to free the spdk_bs_dev structure in their destroy() callback.",
      "revId": "f24cf6abd5f4172d6ee55c3fe3ad93c9aad14015",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "54753976_68baeb93",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 4
      },
      "lineNbr": 1335,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2017-09-24T21:26:31Z",
      "side": 1,
      "message": "OK cool, will try that",
      "parentUuid": "bd9c3b92_8a3ba73a",
      "revId": "f24cf6abd5f4172d6ee55c3fe3ad93c9aad14015",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9b2aa8ec_f97cd6c0",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 4
      },
      "lineNbr": 1335,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2017-09-24T22:24:39Z",
      "side": 1,
      "message": "After looking at this more, what does this buy us over what I\u0027ve done here?  There\u0027 already a spdk_bs_dev struct in the bs so whether I store the cpl info there or in bs what\u0027s the difference?\n\nAlso, what I am doing in this patch is also adding the defer flag so that when spdk_bs_request_set_complete() is called we know whether to call spdk_bs_call_cpl() or not.  Are you sugesting keeping those but jsut moving where the cpl and error number are stored?",
      "parentUuid": "54753976_68baeb93",
      "revId": "f24cf6abd5f4172d6ee55c3fe3ad93c9aad14015",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "a4a195a1_eeafa8df",
        "filename": "lib/util/io_channel.c",
        "patchSetId": 4
      },
      "lineNbr": 284,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-09-21T17:24:04Z",
      "side": 1,
      "message": "We can\u0027t move this outside of the lock.  _spdk_io_device_attempt_free() walks the device list so has to hold the lock.\n\nWe can put a lock/unlock pair in _spdk_io_device_attempt_free(), but can you first explain the problem that precipitated moving this?",
      "revId": "f24cf6abd5f4172d6ee55c3fe3ad93c9aad14015",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "719685aa_a816bbb5",
        "filename": "lib/util/io_channel.c",
        "patchSetId": 4
      },
      "lineNbr": 284,
      "author": {
        "id": 1011289
      },
      "writtenOn": "2017-09-24T21:26:31Z",
      "side": 1,
      "message": "how the heck did I not see that? I moved it to avoid having to make a change in blobfs, you\u0027ll see it after I move it back. Not a huge change",
      "parentUuid": "a4a195a1_eeafa8df",
      "revId": "f24cf6abd5f4172d6ee55c3fe3ad93c9aad14015",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}