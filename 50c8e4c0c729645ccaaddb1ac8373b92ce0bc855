{
  "comments": [
    {
      "key": {
        "uuid": "103d5354_08489707",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 27
      },
      "lineNbr": 104,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2018-01-12T20:52:49Z",
      "side": 1,
      "message": "dummy_bs_dev \u003d\u003e zeroes_bs_dev",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5bad18c9_2e8b6284",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 27
      },
      "lineNbr": 104,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2018-01-15T15:34:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "103d5354_08489707",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "fb3f1321_148337ff",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 27
      },
      "lineNbr": 105,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2018-01-12T20:52:49Z",
      "side": 1,
      "message": "I would make this UINT64_MAX instead of 1 (since effectively the size of this \"zeroes\" device is unlimited).",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f200e815_ee1675d1",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 27
      },
      "lineNbr": 105,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2018-01-15T15:34:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "fb3f1321_148337ff",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "cdd86854_7040076e",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 27
      },
      "lineNbr": 106,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2018-01-12T20:52:49Z",
      "side": 1,
      "message": "I guess 1 is fine, but block devices typically use blocklen 512 or 4096.  I would suggest using one of those here.",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "74b7a05a_062cd49f",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 27
      },
      "lineNbr": 106,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2018-01-15T15:34:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "cdd86854_7040076e",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "15833e73_ac259fb3",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 27
      },
      "lineNbr": 1563,
      "author": {
        "id": 1010531
      },
      "writtenOn": "2018-01-10T23:09:47Z",
      "side": 1,
      "message": "Aren\u0027t the LBA\u0027s on the backing bdev exactly equal to the LBA\u0027s on the new bdev? I understand that the target of the read changes based on whether the cluster is allocated, but aren\u0027t the LBAs the same?",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "4d7cfb89_4e89ed24",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 27
      },
      "lineNbr": 1563,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2018-01-12T14:14:03Z",
      "side": 1,
      "message": "The problem is that on thick provisioned device we translate page to lba using _spdk_bs_blob_page_to_lba function which reads lba from cluster map based on page number. For Thin provisioned bdev, if cluster is unallocated, we will always get lba \u003d 0 which is incorrect. Because of that we have to get lba assuming that page numbers are continuous (which is not true for blobs) and do the real math later based on bs_dev.",
      "parentUuid": "15833e73_ac259fb3",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b463e3b2_1e4b6b1f",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 27
      },
      "lineNbr": 1817,
      "author": {
        "id": 1010531
      },
      "writtenOn": "2018-01-10T23:09:47Z",
      "side": 1,
      "message": "I think burying the setting of which I/O device to target inside this function just makes things confusing. I\u0027d rather see this written right here as:\n\nif (read) {\n    if (\u003cutility function that checks whether a page is allocated\u003e) {\n        spdk_bs_sequence_readv to local disk\n    } else {\n        spdk_bs_sequence_readv to backing bdev\n    }\n}",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1cb552f6_a011d0cc",
        "filename": "lib/blob/blobstore.c",
        "patchSetId": 27
      },
      "lineNbr": 1817,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2018-01-12T14:14:03Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "b463e3b2_1e4b6b1f",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "392f7dbc_2de197ad",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 352,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2018-01-12T20:52:49Z",
      "side": 1,
      "message": "I think these could be simplified to just _spdk_bs_dev_byte_to_lba(), and then pass the bs_dev (not the blob).\n\nThis could actually make these functions reusable down the road in case we also needed conversion functions for a different bs_dev.\n\nThen the caller just passes blob-\u003ebs_dev.",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2e106bea_8c9329e6",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 352,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2018-01-15T15:34:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "392f7dbc_2de197ad",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "864500f6_b2ea840e",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 372,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2018-01-12T20:52:49Z",
      "side": 1,
      "message": "_spdk_bs_dev_page_to_lba (similar to above)",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "18ab72d9_6bba6f51",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 372,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2018-01-15T15:34:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "864500f6_b2ea840e",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c7b77721_50618e7b",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 390,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2018-01-12T20:52:49Z",
      "side": 1,
      "message": "_spdk_bs_dev_lba_to_page",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "b17b9131_ab02773a",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 390,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2018-01-15T15:34:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "c7b77721_50618e7b",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5f298b3d_30ddd275",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 491,
      "author": {
        "id": 1010531
      },
      "writtenOn": "2018-01-10T23:09:47Z",
      "side": 1,
      "message": "_spdk_bs_page_to_cluster_start?",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "2e08fe4d_9bd70203",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 491,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2018-01-12T14:14:03Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "5f298b3d_30ddd275",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "bd5e2d1a_0a329965",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 491,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2018-01-12T20:52:49Z",
      "side": 1,
      "message": "curent \u003d\u003e current",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "764154d1_637bb0e7",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 503,
      "author": {
        "id": 1010531
      },
      "writtenOn": "2018-01-10T23:09:47Z",
      "side": 1,
      "message": "_spdk_bs_blob_is_page_allocated?",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "12c36c75_19e30d42",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 503,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2018-01-12T14:14:03Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "764154d1_637bb0e7",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "1ce977c3_b26dd3f0",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 504,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2018-01-12T20:52:49Z",
      "side": 1,
      "message": "_spdk_bs_page_is_allocated?\n\nthat name would be simpler, and I think expresses the same meaning",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "d36a0621_90b6a0ec",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 504,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2018-01-15T15:34:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "1ce977c3_b26dd3f0",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "466867e5_1b40fe5e",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 515,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2018-01-12T20:52:49Z",
      "side": 1,
      "message": "is bool cast needed here?",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "490d2299_64cb4c3d",
        "filename": "lib/blob/blobstore.h",
        "patchSetId": 27
      },
      "lineNbr": 515,
      "author": {
        "id": 1011262
      },
      "writtenOn": "2018-01-15T15:34:28Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "466867e5_1b40fe5e",
      "revId": "50c8e4c0c729645ccaaddb1ac8373b92ce0bc855",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}