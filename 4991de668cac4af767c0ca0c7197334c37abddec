{
  "comments": [
    {
      "key": {
        "uuid": "04e96ff0_6a970d0e",
        "filename": "/COMMIT_MSG",
        "patchSetId": 2
      },
      "lineNbr": 7,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-10-06T03:51:17Z",
      "side": 1,
      "message": "should be scsi: instead of iscsi: (since this only touches scsi directory)",
      "revId": "4991de668cac4af767c0ca0c7197334c37abddec",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "39c50fe7_dd78a3b1",
        "filename": "lib/scsi/dev.c",
        "patchSetId": 2
      },
      "lineNbr": 232,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-10-06T03:51:17Z",
      "side": 1,
      "message": "this check needs to add \"\u0026\u0026 dev-\u003eport[i].is_valid\"\n\ncould you also add a unit test to catch this bug?\n\nthanks,\n\nJim",
      "revId": "4991de668cac4af767c0ca0c7197334c37abddec",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "23a40b06_2e62e916",
        "filename": "lib/scsi/dev.c",
        "patchSetId": 2
      },
      "lineNbr": 232,
      "author": {
        "id": 1012251
      },
      "writtenOn": "2017-10-06T09:51:35Z",
      "side": 1,
      "message": "Thank you, I\u0027m getting used to this activity a little by little. I will  add CUnit based UTs to the test director and confirm the fix by using these.",
      "parentUuid": "39c50fe7_dd78a3b1",
      "revId": "4991de668cac4af767c0ca0c7197334c37abddec",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "f7767d18_2ba7e0c0",
        "filename": "lib/scsi/dev.c",
        "patchSetId": 2
      },
      "lineNbr": 232,
      "author": {
        "id": 1010525
      },
      "writtenOn": "2017-10-06T20:59:33Z",
      "side": 1,
      "message": "Since you are editing this patch anyway, I think it would be good to clarify this part a little bit.\n\nI believe this loop is trying to do two things:\n1. Check for duplicate port ID values\n2. Find an empty slot to put the new port into\n\nI think it would be clearer to split these up into two separate loops (even if it\u0027s slightly less efficient, this shouldn\u0027t matter much with the small array sizes we are dealing with here).  At least, the two checks should have some comments describing what they are doing.\n\nOther than that, and Jim\u0027s comment about is_valid above, looks good to me.",
      "parentUuid": "23a40b06_2e62e916",
      "revId": "4991de668cac4af767c0ca0c7197334c37abddec",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e6ccdf34_e32cc96f",
        "filename": "lib/scsi/dev.c",
        "patchSetId": 2
      },
      "lineNbr": 232,
      "author": {
        "id": 1012251
      },
      "writtenOn": "2017-10-07T00:19:36Z",
      "side": 1,
      "message": "Thank you Dan, Jim,\n\nwhat I did internally was the following.\nHowever, I did a bad optimization as you mentioned.\n\nI confirmed the following code worked correctly, but I have not succeeded to create UT code for it. Hence I have not proposed it yet.  \n\nIf the following satisfies your expectation, I will submit it together with UT code after completing validation of CUnit based UT code.\n\nThank you,\nShuhei    \n\nstatic struct spdk_scsi_port *\nspdk_scsi_dev_find_free_port(struct spdk_scsi_dev *dev)\n{\n    for (i \u003d 0; i \u003c MAX_PORTS; i++) { \n        if (dev-\u003eport[i].is_valid)\n            return \u0026dev-\u003eport[i];\n        return NULL;\n}\n\nint\nscsi_dev_add_port(struct spdk_scsi_dev *dev, uint64_t id, const char *name)\n{\n    struct spdk_scsi_port *port;\n    int rc;\n\n    if (dev-\u003enum_ports \u003d\u003d SPDK_SCSI_DEV_MAX_PORTS)\n        return -1;\n\n    port \u003d spdk_scsi_dev_find_port_by_id(dev, id);\n    if (port !\u003d NULL)\n        return -1;\n\n    port \u003d spdk_scsi_dev_find_free_port(dev);\n    if (port \u003d\u003d NULL)\n        return -1;\n\n    rc \u003d spdk_scsi_port_construct(port, id, dev-\u003enum_ports, name);\n    if (rc !\u003d 0)\n        return rc;\n\n    dev-\u003enum_ports++;\n    return 0;\n}",
      "parentUuid": "f7767d18_2ba7e0c0",
      "revId": "4991de668cac4af767c0ca0c7197334c37abddec",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "0c04b4cd_4447604e",
        "filename": "lib/scsi/dev.c",
        "patchSetId": 2
      },
      "lineNbr": 232,
      "author": {
        "id": 1011222
      },
      "writtenOn": "2017-10-09T16:44:21Z",
      "side": 1,
      "message": "i think this looks good except in spdk_scsi_dev_find_free_port() should it be:\n\nif (!dev-\u003eport[i].is_valid) {\n  return \u0026dev-\u003eport[i];\n}",
      "parentUuid": "e6ccdf34_e32cc96f",
      "revId": "4991de668cac4af767c0ca0c7197334c37abddec",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735",
      "unresolved": false
    }
  ]
}